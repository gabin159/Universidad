<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{layout/layout6 :: head}"></head>
<body class="bg-stone-900 text-stone-100 flex flex-col items-center min-h-screen w-screen">

<header th:replace="~{layout/layout6 :: header}"></header>

<div class="w-screen min-h-screen flex flex-col items-center pt-32 px-6">
    <h1 class="text-4xl font-bold text-yellow-100 mb-6 font-['Poppins']" th:text="${title}">Lista de Startups</h1>

    <!-- Sección: Todas las startups -->
    <section>
        <h2 class="text-2xl font-semibold text-yellow-200 mb-4">Todas las Startups</h2>
        <div class="w-full grid sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <div class="bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-all"
                 th:each="startup : ${todasStartups}">

                <img th:src="@{${startup.logo}}" alt="Logo Startup" class="w-full h-48 object-cover">

                <div class="p-6">
                    <p class="text-lg font-bold text-gray-800">
                        Startup N°: [[${startup.idStartup}]]
                    </p>
                    <h3 class="text-2xl font-semibold text-stone-800" th:text="${startup.nombre}">Nombre Startup</h3>

                    <p class="text-sm text-gray-800">
                        <strong>Descripción:</strong> <span th:text="${startup.descripcion}">Texto</span>
                    </p>
                    <p class="text-sm text-gray-800">
                        <strong>Sector:</strong> <span th:text="${startup.sector}">Sector</span>
                    </p>

                    <p class="text-sm text-gray-800">
                        <strong>Convocatoria:</strong>
                        <span th:text="${startup.convocatoria != null ? startup.convocatoria.titulo : 'N/A'}">Título</span>
                    </p>

                    <div class="mt-4 flex gap-2">
                        <a th:href="@{/modificarStartup/{id}(id=${startup.idStartup})}"
                           class="flex-1 bg-amber-700 text-white text-center py-2 rounded-lg hover:bg-amber-500 transition-all">
                            Editar
                        </a>
                        <form th:action="@{/eliminarStartup/{id}(id=${startup.idStartup})}"
                              method="post" onsubmit="return confirmarEliminacion(event, this);">
                            <button type="submit"
                                    class="bg-red-800 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition-all">
                                Eliminar
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>


    <!-- Toast de Éxito -->
    <div id="toast-exito"
         class="fixed top-5 left-1/2 -translate-x-1/2 bg-green-600 text-white px-6 py-3 rounded-xl
                shadow-xl transition-opacity duration-300 opacity-0 z-50 text-lg font-semibold"
         th:if="${mensajeExito}" th:text="${mensajeExito}">
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script th:inline="javascript">
        window.addEventListener("DOMContentLoaded", function () {
            const toast = document.getElementById("toast-exito");
            if (toast) {
                toast.classList.remove("opacity-0");
                toast.classList.add("opacity-100");
                setTimeout(() => {
                    toast.classList.remove("opacity-100");
                    toast.classList.add("opacity-0");
                }, 3000);
            }

            const successMessage = /*[[${success}]]*/ null;
            if (successMessage && successMessage !== "null" && successMessage.trim() !== "") {
                Swal.fire({
                    icon: "success",
                    title: "Éxito",
                    text: successMessage
                });
            }

            const errorMessage = /*[[${error}]]*/ null;
            if (errorMessage && errorMessage !== "null" && errorMessage.trim() !== "") {
                Swal.fire({
                    icon: "error",
                    title: "Error",
                    text: errorMessage
                });
            }
        });

        function confirmarEliminacion(event, form) {
            event.preventDefault();
            Swal.fire({
                title: "¿Are you sure?",
                text: "This action cannot be undone",
                icon: "warning",
                showCancelButton: true,
                confirmButtonColor: "#991b1b",
                cancelButtonColor: "#f59e0b",
                confirmButtonText: "Yes, delete",
                cancelButtonText: "Cancel"
            }).then((result) => {
                if (result.isConfirmed) {
                    form.submit();
                }
            });
        }
    </script>
</div>

</body>
</html>
